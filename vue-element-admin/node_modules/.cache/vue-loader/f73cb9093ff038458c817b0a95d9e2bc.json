{"remainingRequest":"G:\\基础文档\\Documents\\GitDemo\\rabbit\\vue-element-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\基础文档\\Documents\\GitDemo\\rabbit\\vue-element-admin\\src\\views\\chatroom\\chat.vue?vue&type=style&index=0&id=6ecc720a&lang=scss&scoped=true&","dependencies":[{"path":"G:\\基础文档\\Documents\\GitDemo\\rabbit\\vue-element-admin\\src\\views\\chatroom\\chat.vue","mtime":1646987707157},{"path":"G:\\基础文档\\Documents\\GitDemo\\rabbit\\vue-element-admin\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\基础文档\\Documents\\GitDemo\\rabbit\\vue-element-admin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"G:\\基础文档\\Documents\\GitDemo\\rabbit\\vue-element-admin\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"G:\\基础文档\\Documents\\GitDemo\\rabbit\\vue-element-admin\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\基础文档\\Documents\\GitDemo\\rabbit\\vue-element-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\基础文档\\Documents\\GitDemo\\rabbit\\vue-element-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQouY2hhdC1ib3ggew0KICBtYXJnaW46IDAgYXV0bzsNCiAgYmFja2dyb3VuZDogI2ZhZmFmYTsNCiAgcG9zaXRpb246IGFic29sdXRlOw0KICBoZWlnaHQ6IDEwMCU7DQogIHdpZHRoOiAxMDAlOw0KICBtYXgtd2lkdGg6IDcwMHB4Ow0KICBoZWFkZXIgew0KICAgIHBvc2l0aW9uOiBmaXhlZDsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBoZWlnaHQ6IDNyZW07DQogICAgYmFja2dyb3VuZDogIzQwOWVmZjsNCiAgICBtYXgtd2lkdGg6IDcwMHB4Ow0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICBjb2xvcjogd2hpdGU7DQogICAgZm9udC1zaXplOiAxcmVtOw0KICB9DQogIC5tc2ctYm94IHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgaGVpZ2h0OiBjYWxjKDEwMCUgLSA2LjVyZW0pOw0KICAgIHdpZHRoOiAxMDAlOw0KICAgIG1hcmdpbi10b3A6IDNyZW07DQogICAgb3ZlcmZsb3cteTogc2Nyb2xsOw0KICAgIC5tc2cgew0KICAgICAgd2lkdGg6IDk1JTsNCiAgICAgIG1pbi1oZWlnaHQ6IDIuNXJlbTsNCiAgICAgIG1hcmdpbjogMXJlbSAwLjVyZW07DQogICAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQogICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAganVzdGlmeS1jb250ZW50OiBmbGV4LXN0YXJ0ICFpbXBvcnRhbnQ7DQogICAgICAudXNlci1oZWFkIHsNCiAgICAgICAgbWluLXdpZHRoOiAyLjVyZW07DQogICAgICAgIHdpZHRoOiAyMCU7DQogICAgICAgIHdpZHRoOiAyLjVyZW07DQogICAgICAgIGhlaWdodDogMi41cmVtOw0KICAgICAgICBib3JkZXItcmFkaXVzOiA1MCU7DQogICAgICAgIGJhY2tncm91bmQ6ICNmMWYxZjE7DQogICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgICAgICAuaGVhZCB7DQogICAgICAgICAgd2lkdGg6IDEuMnJlbTsNCiAgICAgICAgICBoZWlnaHQ6IDEuMnJlbTsNCiAgICAgICAgfQ0KICAgICAgICAvLyBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgICB9DQogICAgICAudXNlci1tc2cgew0KICAgICAgICB3aWR0aDogODAlOw0KICAgICAgICAvLyBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgICAgIHdvcmQtYnJlYWs6IGJyZWFrLWFsbDsNCiAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICAgICAgICB6LWluZGV4OiA1Ow0KICAgICAgICBzcGFuIHsNCiAgICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7DQogICAgICAgICAgcGFkZGluZzogMC41cmVtIDAuN3JlbTsNCiAgICAgICAgICBib3JkZXItcmFkaXVzOiAwLjVyZW07DQogICAgICAgICAgbWFyZ2luLXRvcDogMC4ycmVtOw0KICAgICAgICAgIGZvbnQtc2l6ZTogMC44OHJlbTsNCiAgICAgICAgfQ0KICAgICAgICAubGVmdCB7DQogICAgICAgICAgYmFja2dyb3VuZDogd2hpdGU7DQogICAgICAgICAgYW5pbWF0aW9uOiB0b0xlZnQgMC41cyBlYXNlIGJvdGggMTsNCiAgICAgICAgfQ0KICAgICAgICAucmlnaHQgew0KICAgICAgICAgIGJhY2tncm91bmQ6ICM1M2E4ZmY7DQogICAgICAgICAgY29sb3I6IHdoaXRlOw0KICAgICAgICAgIGFuaW1hdGlvbjogdG9yaWdodCAwLjVzIGVhc2UgYm90aCAxOw0KICAgICAgICB9DQogICAgICAgIEBrZXlmcmFtZXMgdG9MZWZ0IHsNCiAgICAgICAgICAwJSB7DQogICAgICAgICAgICBvcGFjaXR5OiAwOw0KICAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC0xMHB4KTsNCiAgICAgICAgICB9DQogICAgICAgICAgMTAwJSB7DQogICAgICAgICAgICBvcGFjaXR5OiAxOw0KICAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKDBweCk7DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIEBrZXlmcmFtZXMgdG9yaWdodCB7DQogICAgICAgICAgMCUgew0KICAgICAgICAgICAgb3BhY2l0eTogMDsNCiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgxMHB4KTsNCiAgICAgICAgICB9DQogICAgICAgICAgMTAwJSB7DQogICAgICAgICAgICBvcGFjaXR5OiAxOw0KICAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKDBweCk7DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICB9DQogICAgfQ0KICB9DQogIC5pbnB1dC1ib3ggew0KICAgIHBhZGRpbmc6IDAgMC41cmVtOw0KICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICBib3R0b206IDA7DQogICAgd2lkdGg6IDEwMCU7DQogICAgaGVpZ2h0OiAzLjVyZW07DQogICAgYmFja2dyb3VuZDogI2ZhZmFmYTsNCiAgICBib3gtc2hhZG93OiAwIDAgNXB4ICNjY2M7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBpbnB1dCB7DQogICAgICBoZWlnaHQ6IDIuM3JlbTsNCiAgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsNCiAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgcGFkZGluZzogMC41cmVtOw0KICAgICAgYm9yZGVyOiBub25lOw0KICAgICAgYm9yZGVyLXJhZGl1czogMC4ycmVtOw0KICAgICAgZm9udC1zaXplOiAwLjg4cmVtOw0KICAgIH0NCiAgICAuYnRuIHsNCiAgICAgIGhlaWdodDogMi4zcmVtOw0KICAgICAgbWluLXdpZHRoOiA0cmVtOw0KICAgICAgYmFja2dyb3VuZDogI2UwZTBlMDsNCiAgICAgIHBhZGRpbmc6IDAuNXJlbTsNCiAgICAgIGZvbnQtc2l6ZTogMC44OHJlbTsNCiAgICAgIGNvbG9yOiB3aGl0ZTsNCiAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICAgIGJvcmRlci1yYWRpdXM6IDAuMnJlbTsNCiAgICAgIG1hcmdpbi1sZWZ0OiAwLjVyZW07DQogICAgICB0cmFuc2l0aW9uOiAwLjVzOw0KICAgIH0NCiAgICAuYnRuLWFjdGl2ZSB7DQogICAgICBiYWNrZ3JvdW5kOiAjNDA5ZWZmOw0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["chat.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"chat.vue","sourceRoot":"src/views/chat","sourcesContent":["<template>\r\n  <div class=\"chat-box\">\r\n    <header>聊天室人数：{{count}}</header>\r\n    <div class=\"msg-box\" ref=\"msg-box\">\r\n      <div\r\n        v-for=\"(i,index) in list\"\r\n        :key=\"index\"\r\n        class=\"msg\"\r\n        :style=\"i.userId == userId?'flex-direction:row-reverse':''\"\r\n      >\r\n        <div class=\"user-head\">\r\n          <div\r\n            class=\"head\"\r\n            :style=\"` background: hsl(${getUserHead(i.userId,'bck')}, 88%, 62%); clip-path:polygon(${getUserHead(i.userId,'polygon')}% 0,100% 100%,0% 100%); transform: rotate(${getUserHead(i.userId,'rotate')}deg)`\"\r\n          ></div>\r\n        </div>\r\n        <div class=\"user-msg\">\r\n          <span\r\n            :style=\"i.userId == userId?' float: right;':''\"\r\n            :class=\"i.userId == userId?'right':'left'\"\r\n          >{{i.content}}</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"input-box\">\r\n      <input type=\"text\" ref=\"sendMsg\" v-model=\"contentText\" @keyup.enter=\"sendText()\" />\r\n      <div class=\"btn\" :class=\"{['btn-active']:contentText}\" @click=\"sendText()\">发送</div>\r\n    </div>\r\n  </div>\r\n</template>\r\n \r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      ws: null,\r\n      count: 0,\r\n      userId: null, //当前用户ID\r\n      list: [], //聊天记录的数组\r\n      contentText: \"\" //input输入的值\r\n    };\r\n  },\r\n  created() {\r\n    this.getUserID();\r\n  },\r\n  mounted() {\r\n    this.initWebSocket();\r\n  },\r\n  methods: {\r\n    //根据时间戳作为当前用户ID\r\n    getUserID() {\r\n      let time = new Date().getTime();\r\n      this.userId = time;\r\n    },\r\n    //根据userID生成一个随机头像\r\n    getUserHead(id, type) {\r\n      let ID = String(id);\r\n      if (type == \"bck\") {\r\n        return Number(ID.substring(ID.length - 3));\r\n      }\r\n      if (type == \"polygon\") {\r\n        return Number(ID.substring(ID.length - 2));\r\n      }\r\n      if (type == \"rotate\") {\r\n        return Number(ID.substring(ID.length - 3));\r\n      }\r\n    },\r\n    //滚动条到底部\r\n    scrollBottm() {\r\n      let el = this.$refs[\"msg-box\"];\r\n      el.scrollTop = el.scrollHeight;\r\n    },\r\n    //发送聊天信息\r\n    sendText() {\r\n      let _this = this;\r\n      _this.$refs[\"sendMsg\"].focus();\r\n      if (!_this.contentText) {\r\n        return;\r\n      }\r\n      let params = {\r\n        userId: _this.userId,\r\n        msg: _this.contentText\r\n      };\r\n      _this.ws.send(JSON.stringify(params)); //调用WebSocket send()发送信息的方法\r\n      _this.contentText = \"\";\r\n      setTimeout(() => {\r\n        _this.scrollBottm();\r\n      }, 500);\r\n    },\r\n    //进入页面创建websocket连接\r\n    initWebSocket() {\r\n      let _this = this;\r\n      //判断页面有没有存在websocket连接\r\n      if (window.WebSocket) {\r\n        // 192.168.0.115 是我本地IP地址 此处的 :8181 端口号 要与后端配置的一致\r\n        let ws = new WebSocket(\"ws://127.0.0.1:8081\");\r\n        _this.ws = ws;\r\n        ws.onopen = function(e) {\r\n          console.log(\"服务器连接成功\");\r\n        };\r\n        ws.onclose = function(e) {\r\n          console.log(\"服务器连接关闭\");\r\n        };\r\n        ws.onerror = function() {\r\n          console.log(\"服务器连接出错\");\r\n        };\r\n        ws.onmessage = function(e) {\r\n          //接收服务器返回的数据\r\n          let resData = JSON.parse(e.data);\r\n          if (resData.funName == \"userCount\") {\r\n            _this.count = resData.users;\r\n            _this.list = resData.chat;\r\n            console.log(resData.chat);\r\n          } else {\r\n            _this.list = [\r\n              ..._this.list,\r\n              { userId: resData.userId, content: resData.msg }\r\n            ];\r\n          }\r\n        };\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n \r\n<style lang=\"scss\" scoped>\r\n.chat-box {\r\n  margin: 0 auto;\r\n  background: #fafafa;\r\n  position: absolute;\r\n  height: 100%;\r\n  width: 100%;\r\n  max-width: 700px;\r\n  header {\r\n    position: fixed;\r\n    width: 100%;\r\n    height: 3rem;\r\n    background: #409eff;\r\n    max-width: 700px;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    font-weight: bold;\r\n    color: white;\r\n    font-size: 1rem;\r\n  }\r\n  .msg-box {\r\n    position: absolute;\r\n    height: calc(100% - 6.5rem);\r\n    width: 100%;\r\n    margin-top: 3rem;\r\n    overflow-y: scroll;\r\n    .msg {\r\n      width: 95%;\r\n      min-height: 2.5rem;\r\n      margin: 1rem 0.5rem;\r\n      position: relative;\r\n      display: flex;\r\n      justify-content: flex-start !important;\r\n      .user-head {\r\n        min-width: 2.5rem;\r\n        width: 20%;\r\n        width: 2.5rem;\r\n        height: 2.5rem;\r\n        border-radius: 50%;\r\n        background: #f1f1f1;\r\n        display: flex;\r\n        justify-content: center;\r\n        align-items: center;\r\n        .head {\r\n          width: 1.2rem;\r\n          height: 1.2rem;\r\n        }\r\n        // position: absolute;\r\n      }\r\n      .user-msg {\r\n        width: 80%;\r\n        // position: absolute;\r\n        word-break: break-all;\r\n        position: relative;\r\n        z-index: 5;\r\n        span {\r\n          display: inline-block;\r\n          padding: 0.5rem 0.7rem;\r\n          border-radius: 0.5rem;\r\n          margin-top: 0.2rem;\r\n          font-size: 0.88rem;\r\n        }\r\n        .left {\r\n          background: white;\r\n          animation: toLeft 0.5s ease both 1;\r\n        }\r\n        .right {\r\n          background: #53a8ff;\r\n          color: white;\r\n          animation: toright 0.5s ease both 1;\r\n        }\r\n        @keyframes toLeft {\r\n          0% {\r\n            opacity: 0;\r\n            transform: translateX(-10px);\r\n          }\r\n          100% {\r\n            opacity: 1;\r\n            transform: translateX(0px);\r\n          }\r\n        }\r\n        @keyframes toright {\r\n          0% {\r\n            opacity: 0;\r\n            transform: translateX(10px);\r\n          }\r\n          100% {\r\n            opacity: 1;\r\n            transform: translateX(0px);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  .input-box {\r\n    padding: 0 0.5rem;\r\n    position: absolute;\r\n    bottom: 0;\r\n    width: 100%;\r\n    height: 3.5rem;\r\n    background: #fafafa;\r\n    box-shadow: 0 0 5px #ccc;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    input {\r\n      height: 2.3rem;\r\n      display: inline-block;\r\n      width: 100%;\r\n      padding: 0.5rem;\r\n      border: none;\r\n      border-radius: 0.2rem;\r\n      font-size: 0.88rem;\r\n    }\r\n    .btn {\r\n      height: 2.3rem;\r\n      min-width: 4rem;\r\n      background: #e0e0e0;\r\n      padding: 0.5rem;\r\n      font-size: 0.88rem;\r\n      color: white;\r\n      text-align: center;\r\n      border-radius: 0.2rem;\r\n      margin-left: 0.5rem;\r\n      transition: 0.5s;\r\n    }\r\n    .btn-active {\r\n      background: #409eff;\r\n    }\r\n  }\r\n}\r\n</style>"]}]}