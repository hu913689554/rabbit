{"remainingRequest":"G:\\基础文档\\Documents\\GitDemo\\rabbit\\vue-element-admin\\node_modules\\babel-loader\\lib\\index.js!G:\\基础文档\\Documents\\GitDemo\\rabbit\\vue-element-admin\\node_modules\\eslint-loader\\index.js??ref--13-0!G:\\基础文档\\Documents\\GitDemo\\rabbit\\vue-element-admin\\src\\store\\modules\\permission.js","dependencies":[{"path":"G:\\基础文档\\Documents\\GitDemo\\rabbit\\vue-element-admin\\src\\store\\modules\\permission.js","mtime":1646908109350},{"path":"G:\\基础文档\\Documents\\GitDemo\\rabbit\\vue-element-admin\\babel.config.js","mtime":1646385770904},{"path":"G:\\基础文档\\Documents\\GitDemo\\rabbit\\vue-element-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\基础文档\\Documents\\GitDemo\\rabbit\\vue-element-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"G:\\基础文档\\Documents\\GitDemo\\rabbit\\vue-element-admin\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkIGZyb20gIkc6L1x1NTdGQVx1Nzg0MFx1NjU4N1x1Njg2My9Eb2N1bWVudHMvR2l0RGVtby9yYWJiaXQvdnVlLWVsZW1lbnQtYWRtaW4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2ludGVyb3BSZXF1aXJlV2lsZGNhcmQuanMiOwppbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tICJHOi9cdTU3RkFcdTc4NDBcdTY1ODdcdTY4NjMvRG9jdW1lbnRzL0dpdERlbW8vcmFiYml0L3Z1ZS1lbGVtZW50LWFkbWluL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiOwppbXBvcnQgeyBhc3luY1JvdXRlcywgY29uc3RhbnRSb3V0ZXMgfSBmcm9tICdAL3JvdXRlcic7CmltcG9ydCB7IGdldE1lbnUgfSBmcm9tICdAL2FwaS91c2VyJzsKaW1wb3J0IExheW91dCBmcm9tICdAL2xheW91dCc7IC8vTGF5b3V0IOaYr+aetuaehOe7hOS7tu+8jOS4jeWcqOWQjuWPsOi/lOWbnu+8jOWcqOaWh+S7tumHjOWNleeLrOW8leWFpQoKLyoqDQogKiBVc2UgbWV0YS5yb2xlIHRvIGRldGVybWluZSBpZiB0aGUgY3VycmVudCB1c2VyIGhhcyBwZXJtaXNzaW9uDQogKiBAcGFyYW0gcm9sZXMNCiAqIEBwYXJhbSByb3V0ZQ0KICovCgpmdW5jdGlvbiBoYXNQZXJtaXNzaW9uKHJvbGVzLCByb3V0ZSkgewogIGlmIChyb3V0ZS5tZXRhICYmIHJvdXRlLm1ldGEucm9sZXMpIHsKICAgIHJldHVybiByb2xlcy5zb21lKGZ1bmN0aW9uIChyb2xlKSB7CiAgICAgIHJldHVybiByb3V0ZS5tZXRhLnJvbGVzLmluY2x1ZGVzKHJvbGUpOwogICAgfSk7CiAgfSBlbHNlIHsKICAgIHJldHVybiB0cnVlOwogIH0KfQovKioNCiAqIEZpbHRlciBhc3luY2hyb25vdXMgcm91dGluZyB0YWJsZXMgYnkgcmVjdXJzaW9uDQogKiBAcGFyYW0gcm91dGVzIGFzeW5jUm91dGVzDQogKiBAcGFyYW0gcm9sZXMNCiAqLwoKCmV4cG9ydCBmdW5jdGlvbiBmaWx0ZXJBc3luY1JvdXRlcyhyb3V0ZXMsIHJvbGVzKSB7CiAgdmFyIHJlcyA9IFtdOwogIHJvdXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChyb3V0ZSkgewogICAgdmFyIHRtcCA9IF9vYmplY3RTcHJlYWQoe30sIHJvdXRlKTsKCiAgICBpZiAoaGFzUGVybWlzc2lvbihyb2xlcywgdG1wKSkgewogICAgICBpZiAodG1wLmNoaWxkcmVuKSB7CiAgICAgICAgdG1wLmNoaWxkcmVuID0gZmlsdGVyQXN5bmNSb3V0ZXModG1wLmNoaWxkcmVuLCByb2xlcyk7CiAgICAgIH0KCiAgICAgIHJlcy5wdXNoKHRtcCk7CiAgICB9CiAgfSk7CiAgcmV0dXJuIHJlczsKfQp2YXIgc3RhdGUgPSB7CiAgcm91dGVzOiBbXSwKICBhZGRSb3V0ZXM6IFtdCn07CnZhciBtdXRhdGlvbnMgPSB7CiAgU0VUX1JPVVRFUzogZnVuY3Rpb24gU0VUX1JPVVRFUyhzdGF0ZSwgcm91dGVzKSB7CiAgICBzdGF0ZS5hZGRSb3V0ZXMgPSByb3V0ZXM7CiAgICBzdGF0ZS5yb3V0ZXMgPSBjb25zdGFudFJvdXRlcy5jb25jYXQocm91dGVzKTsgLy9yb3V0ZXMKICB9Cn07CgpmdW5jdGlvbiBmaWx0ZXJBc3luY1JvdXRlcihhc3luY1JvdXRlck1hcCkgewogIC8v6YGN5Y6G5ZCO5Y+w5Lyg5p2l55qE6Lev55Sx5a2X56ym5Liy77yM6L2s5o2i5Li657uE5Lu25a+56LGhCiAgdmFyIGFjY2Vzc2VkUm91dGVycyA9IGFzeW5jUm91dGVyTWFwLmZpbHRlcihmdW5jdGlvbiAocm91dGUpIHsKICAgIGNvbnNvbGUubG9nKCLlvIDlp4vms6jlhoznu4Tku7YiKTsKICAgIGNvbnNvbGUubG9nKHJvdXRlKTsKCiAgICBpZiAocm91dGUuY29tcG9uZW50KSB7CiAgICAgIGlmIChyb3V0ZS5jb21wb25lbnQgPT09ICdMYXlvdXQnKSB7CiAgICAgICAgLy9MYXlvdXTnu4Tku7bnibnmrorlpITnkIYKICAgICAgICBjb25zb2xlLmxvZygi5rOo5YaMTGF5b3V057uE5Lu2IiArIHJvdXRlLmNvbXBvbmVudCk7CiAgICAgICAgcm91dGUuY29tcG9uZW50ID0gTGF5b3V0OwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBwYXRoID0gcmVxdWlyZSgncGF0aCcpOwoKICAgICAgICByb3V0ZS5jb21wb25lbnQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCIiLmNvbmNhdChyb3V0ZS5jb21wb25lbnQpKS50aGVuKGZ1bmN0aW9uIChzKSB7CiAgICAgICAgICAgIHJldHVybiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKHMpKTsKICAgICAgICAgIH0pOwogICAgICAgIH07CiAgICAgIH0KICAgIH0KCiAgICBpZiAocm91dGUuY2hpbGRyZW4gJiYgcm91dGUuY2hpbGRyZW4ubGVuZ3RoKSB7CiAgICAgIHJvdXRlLmNoaWxkcmVuID0gZmlsdGVyQXN5bmNSb3V0ZXIocm91dGUuY2hpbGRyZW4pOwogICAgfQoKICAgIHJldHVybiB0cnVlOwogIH0pOwogIHJldHVybiBhY2Nlc3NlZFJvdXRlcnM7Cn0KCnZhciBhY3Rpb25zID0gewogIGdlbmVyYXRlUm91dGVzOiBmdW5jdGlvbiBnZW5lcmF0ZVJvdXRlcyhfcmVmLCByb2xlcykgewogICAgdmFyIGNvbW1pdCA9IF9yZWYuY29tbWl0OwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgIGdldE1lbnUoKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIHZhciBhY2Nlc3NlZFJvdXRlczsKICAgICAgICBhY2Nlc3NlZFJvdXRlcyA9IGZpbHRlckFzeW5jUm91dGVyKHJlc3BvbnNlLmRhdGEpOwogICAgICAgIGNvbnNvbGUubG9nKCLms6jlhozlrozmiJAiKTsKICAgICAgICBjb25zb2xlLmxvZyhhY2Nlc3NlZFJvdXRlcyk7CiAgICAgICAgY29tbWl0KCdTRVRfUk9VVEVTJywgYWNjZXNzZWRSb3V0ZXMpOwogICAgICAgIHJlc29sdmUoYWNjZXNzZWRSb3V0ZXMpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgIH0pOyAvLyBsZXQgYWNjZXNzZWRSb3V0ZXMKICAgICAgLy8gaWYgKHJvbGVzLmluY2x1ZGVzKCdhZG1pbicpKSB7IAogICAgICAvLyAgIGFjY2Vzc2VkUm91dGVzID0gYXN5bmNSb3V0ZXMgfHwgW10KICAgICAgLy8gfSBlbHNlIHsKICAgICAgLy8gICBhY2Nlc3NlZFJvdXRlcyA9IGZpbHRlckFzeW5jUm91dGVzKGFzeW5jUm91dGVzLCByb2xlcykKICAgICAgLy8gfQogICAgICAvLyBjb21taXQoJ1NFVF9ST1VURVMnLCBhY2Nlc3NlZFJvdXRlcykKICAgICAgLy8gcmVzb2x2ZShhY2Nlc3NlZFJvdXRlcykKICAgIH0pOwogIH0KfTsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWVzcGFjZWQ6IHRydWUsCiAgc3RhdGU6IHN0YXRlLAogIG11dGF0aW9uczogbXV0YXRpb25zLAogIGFjdGlvbnM6IGFjdGlvbnMKfTs="},{"version":3,"sources":["G:/基础文档/Documents/GitDemo/rabbit/vue-element-admin/src/store/modules/permission.js"],"names":["asyncRoutes","constantRoutes","getMenu","Layout","hasPermission","roles","route","meta","some","role","includes","filterAsyncRoutes","routes","res","forEach","tmp","children","push","state","addRoutes","mutations","SET_ROUTES","concat","filterAsyncRouter","asyncRouterMap","accessedRouters","filter","console","log","component","path","require","length","actions","generateRoutes","commit","Promise","resolve","then","response","accessedRoutes","data","catch","error","namespaced"],"mappings":"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","sourcesContent":["import { asyncRoutes, constantRoutes } from '@/router'\r\nimport { getMenu } from '@/api/user'\r\nimport Layout from '@/layout' //Layout 是架构组件，不在后台返回，在文件里单独引入\r\n\r\n/**\r\n * Use meta.role to determine if the current user has permission\r\n * @param roles\r\n * @param route\r\n */\r\nfunction hasPermission(roles, route) {\r\n  if (route.meta && route.meta.roles) {\r\n    return roles.some(role => route.meta.roles.includes(role))\r\n  } else {\r\n    return true\r\n  }\r\n}\r\n\r\n/**\r\n * Filter asynchronous routing tables by recursion\r\n * @param routes asyncRoutes\r\n * @param roles\r\n */\r\nexport function filterAsyncRoutes(routes, roles) {\r\n  const res = []\r\n\r\n  routes.forEach(route => {\r\n    const tmp = { ...route }\r\n    if (hasPermission(roles, tmp)) {\r\n      if (tmp.children) {\r\n        tmp.children = filterAsyncRoutes(tmp.children, roles)\r\n      }\r\n      res.push(tmp)\r\n    }\r\n  })\r\n\r\n  return res\r\n}\r\n\r\n\r\n\r\n\r\n\r\nconst state = {\r\n  routes: [],\r\n  addRoutes: []\r\n}\r\n\r\nconst mutations = {\r\n  SET_ROUTES: (state, routes) => {\r\n    state.addRoutes = routes\r\n    state.routes =  constantRoutes.concat(routes) //routes\r\n  }\r\n}\r\n\r\n\r\nfunction filterAsyncRouter(asyncRouterMap) { //遍历后台传来的路由字符串，转换为组件对象\r\n  const accessedRouters = asyncRouterMap.filter(route => {\r\n    console.log(\"开始注册组件\")\r\n    console.log(route)\r\n\r\n    if (route.component) {\r\n      if (route.component === 'Layout') {//Layout组件特殊处理\r\n        console.log(\"注册Layout组件\"+route.component)\r\n        route.component = Layout\r\n      } else {\r\n        const path = require('path')\r\n        route.component = () =>import(route.component)\r\n      }\r\n    }\r\n    if (route.children && route.children.length) {\r\n      route.children = filterAsyncRouter(route.children)\r\n    }\r\n    return true\r\n  })\r\n\r\n  return accessedRouters\r\n}\r\n\r\n\r\n\r\nconst actions = {\r\n\r\n\r\n  \r\n  generateRoutes({ commit }, roles) {\r\n\r\n\r\n    return new Promise(resolve => {\r\n      getMenu().then(response => {\r\n        let accessedRoutes\r\n        accessedRoutes=filterAsyncRouter(response.data)\r\n        console.log(\"注册完成\")\r\n        console.log(accessedRoutes)\r\n        commit('SET_ROUTES', accessedRoutes)\r\n        resolve(accessedRoutes)\r\n        }).catch(error => {\r\n          console.log(error)\r\n        }) \r\n     \r\n\r\n\r\n      // let accessedRoutes\r\n      // if (roles.includes('admin')) { \r\n      //   accessedRoutes = asyncRoutes || []\r\n      // } else {\r\n      //   accessedRoutes = filterAsyncRoutes(asyncRoutes, roles)\r\n      // }\r\n      \r\n  \r\n      // commit('SET_ROUTES', accessedRoutes)\r\n      \r\n      // resolve(accessedRoutes)\r\n    })\r\n  }\r\n}\r\n\r\nexport default {\r\n  namespaced: true,\r\n  state,\r\n  mutations,\r\n  actions\r\n}\r\n"]}]}