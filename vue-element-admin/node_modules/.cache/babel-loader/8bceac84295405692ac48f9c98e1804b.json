{"remainingRequest":"G:\\基础文档\\Documents\\GitDemo\\rabbit\\vue-element-admin\\node_modules\\babel-loader\\lib\\index.js!G:\\基础文档\\Documents\\GitDemo\\rabbit\\vue-element-admin\\node_modules\\eslint-loader\\index.js??ref--13-0!G:\\基础文档\\Documents\\GitDemo\\rabbit\\vue-element-admin\\src\\store\\modules\\permission.js","dependencies":[{"path":"G:\\基础文档\\Documents\\GitDemo\\rabbit\\vue-element-admin\\src\\store\\modules\\permission.js","mtime":1646817427041},{"path":"G:\\基础文档\\Documents\\GitDemo\\rabbit\\vue-element-admin\\babel.config.js","mtime":1646385770904},{"path":"G:\\基础文档\\Documents\\GitDemo\\rabbit\\vue-element-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\基础文档\\Documents\\GitDemo\\rabbit\\vue-element-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"G:\\基础文档\\Documents\\GitDemo\\rabbit\\vue-element-admin\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkIGZyb20gIkc6L1x1NTdGQVx1Nzg0MFx1NjU4N1x1Njg2My9Eb2N1bWVudHMvR2l0RGVtby9yYWJiaXQvdnVlLWVsZW1lbnQtYWRtaW4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2ludGVyb3BSZXF1aXJlV2lsZGNhcmQuanMiOwppbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tICJHOi9cdTU3RkFcdTc4NDBcdTY1ODdcdTY4NjMvRG9jdW1lbnRzL0dpdERlbW8vcmFiYml0L3Z1ZS1lbGVtZW50LWFkbWluL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiOwppbXBvcnQgeyBhc3luY1JvdXRlcywgY29uc3RhbnRSb3V0ZXMgfSBmcm9tICdAL3JvdXRlcic7CmltcG9ydCB7IGdldE1lbnUgfSBmcm9tICdAL2FwaS91c2VyJzsKaW1wb3J0IExheW91dCBmcm9tICdAL2xheW91dCc7IC8vTGF5b3V0IOaYr+aetuaehOe7hOS7tu+8jOS4jeWcqOWQjuWPsOi/lOWbnu+8jOWcqOaWh+S7tumHjOWNleeLrOW8leWFpQoKLyoqDQogKiBVc2UgbWV0YS5yb2xlIHRvIGRldGVybWluZSBpZiB0aGUgY3VycmVudCB1c2VyIGhhcyBwZXJtaXNzaW9uDQogKiBAcGFyYW0gcm9sZXMNCiAqIEBwYXJhbSByb3V0ZQ0KICovCgpmdW5jdGlvbiBoYXNQZXJtaXNzaW9uKHJvbGVzLCByb3V0ZSkgewogIGlmIChyb3V0ZS5tZXRhICYmIHJvdXRlLm1ldGEucm9sZXMpIHsKICAgIHJldHVybiByb2xlcy5zb21lKGZ1bmN0aW9uIChyb2xlKSB7CiAgICAgIHJldHVybiByb3V0ZS5tZXRhLnJvbGVzLmluY2x1ZGVzKHJvbGUpOwogICAgfSk7CiAgfSBlbHNlIHsKICAgIHJldHVybiB0cnVlOwogIH0KfQovKioNCiAqIEZpbHRlciBhc3luY2hyb25vdXMgcm91dGluZyB0YWJsZXMgYnkgcmVjdXJzaW9uDQogKiBAcGFyYW0gcm91dGVzIGFzeW5jUm91dGVzDQogKiBAcGFyYW0gcm9sZXMNCiAqLwoKCmV4cG9ydCBmdW5jdGlvbiBmaWx0ZXJBc3luY1JvdXRlcyhyb3V0ZXMsIHJvbGVzKSB7CiAgdmFyIHJlcyA9IFtdOwogIHJvdXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChyb3V0ZSkgewogICAgdmFyIHRtcCA9IF9vYmplY3RTcHJlYWQoe30sIHJvdXRlKTsKCiAgICBpZiAoaGFzUGVybWlzc2lvbihyb2xlcywgdG1wKSkgewogICAgICBpZiAodG1wLmNoaWxkcmVuKSB7CiAgICAgICAgdG1wLmNoaWxkcmVuID0gZmlsdGVyQXN5bmNSb3V0ZXModG1wLmNoaWxkcmVuLCByb2xlcyk7CiAgICAgIH0KCiAgICAgIHJlcy5wdXNoKHRtcCk7CiAgICB9CiAgfSk7CiAgcmV0dXJuIHJlczsKfQp2YXIgc3RhdGUgPSB7CiAgcm91dGVzOiBbXSwKICBhZGRSb3V0ZXM6IFtdCn07CnZhciBtdXRhdGlvbnMgPSB7CiAgU0VUX1JPVVRFUzogZnVuY3Rpb24gU0VUX1JPVVRFUyhzdGF0ZSwgcm91dGVzKSB7CiAgICBzdGF0ZS5hZGRSb3V0ZXMgPSByb3V0ZXM7CiAgICBzdGF0ZS5yb3V0ZXMgPSBjb25zdGFudFJvdXRlcy5jb25jYXQocm91dGVzKTsgLy9yb3V0ZXMKICB9Cn07CgpmdW5jdGlvbiBmaWx0ZXJBc3luY1JvdXRlcihhc3luY1JvdXRlck1hcCkgewogIC8v6YGN5Y6G5ZCO5Y+w5Lyg5p2l55qE6Lev55Sx5a2X56ym5Liy77yM6L2s5o2i5Li657uE5Lu25a+56LGhCiAgdmFyIGFjY2Vzc2VkUm91dGVycyA9IGFzeW5jUm91dGVyTWFwLmZpbHRlcihmdW5jdGlvbiAocm91dGUpIHsKICAgIGlmIChyb3V0ZS5jb21wb25lbnQpIHsKICAgICAgaWYgKHJvdXRlLmNvbXBvbmVudCA9PT0gJ0xheW91dCcpIHsKICAgICAgICAvL0xheW91dOe7hOS7tueJueauiuWkhOeQhgogICAgICAgIHJvdXRlLmNvbXBvbmVudCA9IExheW91dDsKICAgICAgfSBlbHNlIHsKICAgICAgICByb3V0ZS5jb21wb25lbnQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCIiLmNvbmNhdChyb3V0ZS5jb21wb25lbnQpKS50aGVuKGZ1bmN0aW9uIChzKSB7CiAgICAgICAgICAgIHJldHVybiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKHMpKTsKICAgICAgICAgIH0pOwogICAgICAgIH07CiAgICAgIH0KICAgIH0KCiAgICBpZiAocm91dGUuY2hpbGRyZW4gJiYgcm91dGUuY2hpbGRyZW4ubGVuZ3RoKSB7CiAgICAgIHJvdXRlLmNoaWxkcmVuID0gZmlsdGVyQXN5bmNSb3V0ZXIocm91dGUuY2hpbGRyZW4pOwogICAgfQoKICAgIHJldHVybiB0cnVlOwogIH0pOwogIHJldHVybiBhY2Nlc3NlZFJvdXRlcnM7Cn0KCnZhciBhY3Rpb25zID0gewogIGdlbmVyYXRlUm91dGVzOiBmdW5jdGlvbiBnZW5lcmF0ZVJvdXRlcyhfcmVmLCByb2xlcykgewogICAgdmFyIGNvbW1pdCA9IF9yZWYuY29tbWl0OwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgIC8vIGdldE1lbnUoKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgLy8gICBsZXQgYWNjZXNzZWRSb3V0ZXMKICAgICAgLy8gICBhY2Nlc3NlZFJvdXRlcz1maWx0ZXJBc3luY1JvdXRlcihyZXNwb25zZS5kYXRhKQogICAgICAvLyAgIGNvbW1pdCgnU0VUX1JPVVRFUycsIGFjY2Vzc2VkUm91dGVzKQogICAgICAvLyAgIHJlc29sdmUoYWNjZXNzZWRSb3V0ZXMpCiAgICAgIC8vICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAvLyAgICAgY29uc29sZS5sb2coZXJyb3IpCiAgICAgIC8vICAgfSkKICAgICAgdmFyIGFjY2Vzc2VkUm91dGVzOwoKICAgICAgaWYgKHJvbGVzLmluY2x1ZGVzKCdhZG1pbicpKSB7CiAgICAgICAgYWNjZXNzZWRSb3V0ZXMgPSBhc3luY1JvdXRlcyB8fCBbXTsKICAgICAgfSBlbHNlIHsKICAgICAgICBhY2Nlc3NlZFJvdXRlcyA9IGZpbHRlckFzeW5jUm91dGVzKGFzeW5jUm91dGVzLCByb2xlcyk7CiAgICAgIH0KCiAgICAgIGNvbnNvbGUubG9nKCLmraPnoa7nmoQiKTsKICAgICAgY29uc29sZS5sb2coYXN5bmNSb3V0ZXMpOwogICAgICBjb21taXQoJ1NFVF9ST1VURVMnLCBhY2Nlc3NlZFJvdXRlcyk7CiAgICAgIHJlc29sdmUoYWNjZXNzZWRSb3V0ZXMpOwogICAgfSk7CiAgfQp9OwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZXNwYWNlZDogdHJ1ZSwKICBzdGF0ZTogc3RhdGUsCiAgbXV0YXRpb25zOiBtdXRhdGlvbnMsCiAgYWN0aW9uczogYWN0aW9ucwp9Ow=="},{"version":3,"sources":["G:/基础文档/Documents/GitDemo/rabbit/vue-element-admin/src/store/modules/permission.js"],"names":["asyncRoutes","constantRoutes","getMenu","Layout","hasPermission","roles","route","meta","some","role","includes","filterAsyncRoutes","routes","res","forEach","tmp","children","push","state","addRoutes","mutations","SET_ROUTES","concat","filterAsyncRouter","asyncRouterMap","accessedRouters","filter","component","length","actions","generateRoutes","commit","Promise","resolve","accessedRoutes","console","log","namespaced"],"mappings":"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","sourcesContent":["import { asyncRoutes, constantRoutes } from '@/router'\r\nimport { getMenu } from '@/api/user'\r\nimport Layout from '@/layout' //Layout 是架构组件，不在后台返回，在文件里单独引入\r\n\r\n/**\r\n * Use meta.role to determine if the current user has permission\r\n * @param roles\r\n * @param route\r\n */\r\nfunction hasPermission(roles, route) {\r\n  if (route.meta && route.meta.roles) {\r\n    return roles.some(role => route.meta.roles.includes(role))\r\n  } else {\r\n    return true\r\n  }\r\n}\r\n\r\n/**\r\n * Filter asynchronous routing tables by recursion\r\n * @param routes asyncRoutes\r\n * @param roles\r\n */\r\nexport function filterAsyncRoutes(routes, roles) {\r\n  const res = []\r\n\r\n  routes.forEach(route => {\r\n    const tmp = { ...route }\r\n    if (hasPermission(roles, tmp)) {\r\n      if (tmp.children) {\r\n        tmp.children = filterAsyncRoutes(tmp.children, roles)\r\n      }\r\n      res.push(tmp)\r\n    }\r\n  })\r\n\r\n  return res\r\n}\r\n\r\n\r\n\r\n\r\n\r\nconst state = {\r\n  routes: [],\r\n  addRoutes: []\r\n}\r\n\r\nconst mutations = {\r\n  SET_ROUTES: (state, routes) => {\r\n    state.addRoutes = routes\r\n    state.routes =  constantRoutes.concat(routes) //routes\r\n  }\r\n}\r\n\r\n\r\nfunction filterAsyncRouter(asyncRouterMap) { //遍历后台传来的路由字符串，转换为组件对象\r\n  const accessedRouters = asyncRouterMap.filter(route => {\r\n    if (route.component) {\r\n      if (route.component === 'Layout') {//Layout组件特殊处理\r\n        route.component = Layout\r\n      } else {\r\n        route.component = () =>import(route.component)\r\n      }\r\n    }\r\n    if (route.children && route.children.length) {\r\n      route.children = filterAsyncRouter(route.children)\r\n    }\r\n    return true\r\n  })\r\n\r\n  return accessedRouters\r\n}\r\n\r\n\r\n\r\nconst actions = {\r\n\r\n\r\n  \r\n  generateRoutes({ commit }, roles) {\r\n\r\n\r\n    return new Promise(resolve => {\r\n      // getMenu().then(response => {\r\n      //   let accessedRoutes\r\n      //   accessedRoutes=filterAsyncRouter(response.data)\r\n      //   commit('SET_ROUTES', accessedRoutes)\r\n      //   resolve(accessedRoutes)\r\n      //   }).catch(error => {\r\n      //     console.log(error)\r\n      //   })\r\n     \r\n\r\n\r\n      let accessedRoutes\r\n      if (roles.includes('admin')) { \r\n        accessedRoutes = asyncRoutes || []\r\n      } else {\r\n        accessedRoutes = filterAsyncRoutes(asyncRoutes, roles)\r\n      }\r\n      console.log(\"正确的\")\r\n      console.log(asyncRoutes)\r\n      commit('SET_ROUTES', accessedRoutes)\r\n      resolve(accessedRoutes)\r\n    })\r\n  }\r\n}\r\n\r\nexport default {\r\n  namespaced: true,\r\n  state,\r\n  mutations,\r\n  actions\r\n}\r\n"]}]}